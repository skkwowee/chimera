{
  "description": "Full tick parquet storage + React demo viewer",
  "features": [
    {
      "id": "F1",
      "name": "parse_demos parquet output",
      "description": "Rework scripts/parse_demos.py to save full tick data as Parquet + metadata JSONs (rounds, kills, bomb, header). Keep --snapshots flag for backward compat.",
      "files": ["scripts/parse_demos.py"],
      "verify": "cd ~/chimera && source .venv/bin/activate && python scripts/parse_demos.py data/demos/furia-vs-vitality-m1-mirage.dem --dry-run",
      "passes": true
    },
    {
      "id": "F2",
      "name": "gitignore parquet",
      "description": "Add *.parquet to .gitignore if not already covered",
      "files": [".gitignore"],
      "verify": "grep parquet ~/chimera/.gitignore",
      "passes": true
    },
    {
      "id": "F3",
      "name": "export_viewer_data script",
      "description": "New script scripts/export_viewer_data.py that reads parquet files, downsamples to every 16th tick, exports per-round JSON + meta.json + index.json to site/public/viewer-data/. Copies radar maps + map-data.json to site/public/maps/.",
      "files": ["scripts/export_viewer_data.py"],
      "verify": "cd ~/chimera && source .venv/bin/activate && python scripts/export_viewer_data.py --help",
      "passes": true
    },
    {
      "id": "F4",
      "name": "DemoSelector component",
      "description": "React component: dropdown to pick demo file + round.",
      "files": ["site/src/components/DemoSelector.tsx"],
      "verify": "cd ~/chimera/site && ./node_modules/.bin/tsc --noEmit",
      "passes": true
    },
    {
      "id": "F5",
      "name": "MapCanvas component",
      "description": "HTML5 canvas: radar bg + player dots (T=amber, CT=blue), dead markers, tooltips, Nuke multi-level.",
      "files": ["site/src/components/MapCanvas.tsx"],
      "verify": "cd ~/chimera/site && ./node_modules/.bin/tsc --noEmit",
      "passes": true
    },
    {
      "id": "F6",
      "name": "TimelineSlider component",
      "description": "Range input to scrub ticks. Play/pause. Kill event markers on timeline.",
      "files": ["site/src/components/TimelineSlider.tsx"],
      "verify": "cd ~/chimera/site && ./node_modules/.bin/tsc --noEmit",
      "passes": true
    },
    {
      "id": "F7",
      "name": "Viewer page + nav link",
      "description": "Main page at /viewer composing all components. Lazy-loads per-round JSON. Added Viewer link to homepage nav.",
      "files": ["site/src/app/viewer/page.tsx", "site/src/app/page.tsx"],
      "verify": "cd ~/chimera/site && npm run build",
      "passes": true
    },
    {
      "id": "F8",
      "name": "PostCSS config",
      "description": "Added postcss.config.mjs for Tailwind v4 production builds. Without this, styles break in npm run build/start.",
      "files": ["site/postcss.config.mjs"],
      "verify": "cd ~/chimera/site && npm run build && test -f postcss.config.mjs",
      "passes": true
    },
    {
      "id": "F9",
      "name": "Vision cones on MapCanvas",
      "description": "Add yaw/pitch to parse_demos.py PLAYER_PROPS and parquet output. Add yaw to export_viewer_data.py per-player frame data. Draw semi-transparent FOV cone (90 deg) from each alive player in MapCanvas. Requires: re-parse all 4 demos, re-export viewer data, update MapCanvas rendering.",
      "files": ["scripts/parse_demos.py", "scripts/export_viewer_data.py", "site/src/components/MapCanvas.tsx"],
      "verify": "Check viewer shows triangular vision cones extending from player dots in correct yaw direction",
      "passes": true
    },
    {
      "id": "F10",
      "name": "Kill lines on MapCanvas",
      "description": "Draw attacker→victim lines at the tick a kill occurs. Use kill data from meta.json. Highlight on timeline and flash briefly on canvas when scrubbing past a kill tick.",
      "files": ["site/src/components/MapCanvas.tsx", "site/src/app/viewer/page.tsx"],
      "verify": "Scrub to a kill tick and see a line drawn between attacker and victim positions",
      "passes": true
    },
    {
      "id": "F11",
      "name": "Wall-clipped vision cones",
      "description": "Vision cones raycast against radar PNG wall mask instead of drawing through walls. Wall mask extracted from alpha channel (edge detection at opaque/transparent boundaries) + dark opaque pixels (interior wall outlines). 90 rays at 1px steps per player. Also split upper/lower canvas rendering for Nuke.",
      "files": ["site/src/components/MapCanvas.tsx"],
      "verify": "cd ~/chimera/site && npm run build && echo 'Open Mirage viewer — cones clip at mid doors, B apts entrance, A ramp walls'",
      "passes": true
    }
  ]
}
